import gsap from 'gsap';
import { useAtom } from 'jotai';
import { useEffect, useRef } from 'react';
import { mediaAtom } from '../../../lib/agent';
import Image from '../../Image';
import Noise from './assets/noise.png';

function Logo() {
  return (
    <svg
      width="58"
      height="56"
      viewBox="0 0 58 56"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <ellipse cx="29.001" cy="28.0007" rx="29" ry="28" fill="#19191B" />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M39.5683 14.0002L36.1256 19.6114C37.2986 21.0759 37.9937 22.9221 37.9937 24.9423H32.9781C32.9781 22.7751 31.2588 21.0697 29.0376 21.0697V16.2739C30.2463 16.2739 31.396 16.5 32.444 16.9115L34.2304 14.0002H39.5683ZM29.0332 28.8148C26.8116 28.8148 25.0919 27.1098 25.0919 24.9426H20.0767C20.0767 27.7932 21.4609 30.2977 23.6187 31.8721L18.0024 41.1428H23.3404L23.3404 41.1427H38.2751V36.4529H26.1814L27.9405 33.5489C28.2984 33.5902 28.663 33.6114 29.0332 33.6114V31.7451L29.0376 31.7378V33.6112C34.0171 33.6112 37.9937 29.7741 37.9937 24.9425H32.9781C32.9781 27.1097 31.2588 28.8147 29.0376 28.8147V31.2664H29.0332V28.8148ZM20.0767 24.9425C20.0767 20.1109 24.0533 16.2742 29.0332 16.2742V21.07C26.8116 21.07 25.0919 22.7753 25.0919 24.9425H20.0767Z"
        fill="#F0F6FF"
      />
    </svg>
  );
}

function Shape() {
  return (
    <svg
      width="1440"
      height="512"
      viewBox="0 0 1440 512"
      fill="none"
      // xmlns="http://www.w3.org/2000/svg"
      // xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <g clipPath="url(#clip0_2201_382)">
        <rect
          // transform-origin: 60.555625% 49.8048828125%;
          opacity="0.33"
          x="348"
          y="35.0001"
          width="440"
          height="440"
          rx="220"
          fill="url(#pattern0)"
        />
        <circle opacity="0.3" cx="872" cy="255" r="219.5" stroke="#19191B" />
        <path
          className="rect-right"
          d="M657.871 206.745C668.539 159.406 694.593 116.937 731.96 85.9774C769.327 55.0178 815.9 37.3134 864.397 35.6324C912.894 33.9513 960.581 48.3883 1000 76.6862C1039.42 104.984 1068.36 145.547 1082.28 192.034C1096.2 238.521 1094.32 288.31 1076.94 333.616C1059.56 378.923 1027.66 417.194 986.217 442.444C944.777 467.694 896.139 478.501 847.906 473.174C799.673 467.847 754.565 446.688 719.635 413.003"
          stroke="#19191B"
        />
        <circle opacity="0.3" cx="568" cy="255" r="219.5" stroke="#19191B" />
        <path
          className="rect-left"
          d="M489.325 459.916C449.132 444.485 414.365 417.574 389.35 382.533C364.335 347.492 350.177 305.868 348.639 262.842C347.101 219.816 358.25 177.288 380.699 140.55C403.147 103.812 435.904 74.4872 474.893 56.225C513.881 37.9628 557.38 31.5697 599.974 37.8414C642.568 44.1131 682.378 62.7726 714.448 91.4976C746.518 120.223 769.432 157.745 780.339 199.394C791.246 241.043 789.663 284.98 775.789 325.737"
          stroke="#19191B"
        />
        <path
          d="M481.258 257.528C481.258 256.544 480.682 255.812 479.614 255.512C480.442 255.152 480.934 254.456 480.934 253.64C480.934 252.188 479.89 251.384 478.15 251.384H475.162V260H478.318C480.106 260 481.258 259.1 481.258 257.528ZM478.066 252.44C479.11 252.44 479.674 252.932 479.674 253.736C479.674 254.54 479.11 255.032 478.066 255.032H476.374V252.44H478.066ZM478.234 256.088C479.362 256.088 479.998 256.616 479.998 257.492C479.998 258.404 479.362 258.944 478.234 258.944H476.374V256.088H478.234ZM489.239 251.384H487.919V256.94C487.919 258.188 487.187 258.992 485.903 258.992C484.631 258.992 483.899 258.188 483.899 256.94V251.384H482.579V256.904C482.579 258.884 483.839 260.18 485.903 260.18C487.967 260.18 489.239 258.884 489.239 256.904V251.384ZM497.376 257.48C497.376 256.196 496.548 255.548 495.072 255.248L493.8 254.996C492.996 254.828 492.288 254.54 492.288 253.724C492.288 252.98 492.9 252.32 494.016 252.32C495.096 252.32 495.84 253.04 495.912 254.072H497.256C497.148 252.356 495.792 251.264 494.004 251.264C492.216 251.264 490.944 252.356 490.944 253.808C490.944 255.272 492.048 255.884 493.26 256.124L494.508 256.364C495.504 256.58 495.972 256.94 495.972 257.66C495.972 258.548 495.156 259.064 494.064 259.064C492.744 259.064 492.048 258.356 491.988 257.264H490.644C490.752 258.98 492.012 260.12 494.088 260.12C496.176 260.12 497.376 258.98 497.376 257.48ZM500.224 260V251.384H498.904V260H500.224ZM507.852 260H509.184V251.384H507.96V257.936L503.532 251.384H502.092V260H503.316V253.268L507.852 260ZM516.505 258.848H512.365V256.136H516.061V254.984H512.365V252.536H516.421V251.384H511.045V260H516.505V258.848ZM524.353 257.48C524.353 256.196 523.525 255.548 522.049 255.248L520.777 254.996C519.973 254.828 519.265 254.54 519.265 253.724C519.265 252.98 519.877 252.32 520.993 252.32C522.073 252.32 522.817 253.04 522.889 254.072H524.233C524.125 252.356 522.769 251.264 520.981 251.264C519.193 251.264 517.921 252.356 517.921 253.808C517.921 255.272 519.025 255.884 520.237 256.124L521.485 256.364C522.481 256.58 522.949 256.94 522.949 257.66C522.949 258.548 522.133 259.064 521.041 259.064C519.721 259.064 519.025 258.356 518.965 257.264H517.621C517.729 258.98 518.989 260.12 521.065 260.12C523.153 260.12 524.353 258.98 524.353 257.48ZM532.181 257.48C532.181 256.196 531.353 255.548 529.877 255.248L528.605 254.996C527.801 254.828 527.093 254.54 527.093 253.724C527.093 252.98 527.705 252.32 528.821 252.32C529.901 252.32 530.645 253.04 530.717 254.072H532.061C531.953 252.356 530.597 251.264 528.809 251.264C527.021 251.264 525.749 252.356 525.749 253.808C525.749 255.272 526.853 255.884 528.065 256.124L529.313 256.364C530.309 256.58 530.777 256.94 530.777 257.66C530.777 258.548 529.961 259.064 528.869 259.064C527.549 259.064 526.853 258.356 526.793 257.264H525.449C525.557 258.98 526.817 260.12 528.893 260.12C530.981 260.12 532.181 258.98 532.181 257.48Z"
          fill="#19191B"
        />
        <path
          d="M371.647 255.647C371.452 255.842 371.452 256.159 371.647 256.354L374.829 259.536C375.025 259.732 375.341 259.732 375.537 259.536C375.732 259.341 375.732 259.024 375.537 258.829L372.708 256.001L375.537 253.172C375.732 252.977 375.732 252.66 375.537 252.465C375.341 252.27 375.025 252.27 374.829 252.465L371.647 255.647ZM372.001 256.501L412.001 256.501L412.001 255.501L372.001 255.501L372.001 256.501Z"
          fill="#19191B"
        />
        <path
          d="M902.939 260.177C905.099 260.177 906.827 258.737 907.151 256.601H905.747C905.507 257.993 904.379 258.989 902.951 258.989C901.247 258.989 900.047 257.609 900.047 255.677C900.047 253.769 901.247 252.389 902.951 252.389C904.379 252.389 905.507 253.373 905.747 254.765H907.151C906.827 252.641 905.099 251.201 902.939 251.201C900.539 251.201 898.679 253.145 898.679 255.677C898.679 258.221 900.539 260.177 902.939 260.177ZM915.158 251.381H913.838V256.937C913.838 258.185 913.106 258.989 911.822 258.989C910.55 258.989 909.818 258.185 909.818 256.937V251.381H908.498V256.901C908.498 258.881 909.758 260.177 911.822 260.177C913.886 260.177 915.158 258.881 915.158 256.901V251.381ZM923.295 257.477C923.295 256.193 922.467 255.545 920.991 255.245L919.719 254.993C918.915 254.825 918.207 254.537 918.207 253.721C918.207 252.977 918.819 252.317 919.935 252.317C921.015 252.317 921.759 253.037 921.831 254.069H923.175C923.067 252.353 921.711 251.261 919.923 251.261C918.135 251.261 916.863 252.353 916.863 253.805C916.863 255.269 917.967 255.881 919.179 256.121L920.427 256.361C921.423 256.577 921.891 256.937 921.891 257.657C921.891 258.545 921.075 259.061 919.983 259.061C918.663 259.061 917.967 258.353 917.907 257.261H916.563C916.671 258.977 917.931 260.117 920.007 260.117C922.095 260.117 923.295 258.977 923.295 257.477ZM927.939 259.997V252.569H930.747V251.381H923.811V252.569H926.619V259.997H927.939ZM935.309 260.177C937.805 260.177 939.689 258.221 939.689 255.677C939.689 253.133 937.805 251.201 935.309 251.201C932.813 251.201 930.929 253.133 930.929 255.677C930.929 258.221 932.813 260.177 935.309 260.177ZM935.309 258.989C933.485 258.989 932.297 257.525 932.297 255.677C932.297 253.829 933.485 252.389 935.309 252.389C937.133 252.389 938.321 253.829 938.321 255.677C938.321 257.525 937.133 258.989 935.309 258.989ZM944.99 259.997H946.118L948.854 253.397V259.997H950.078V251.381H948.446L945.566 258.377L942.674 251.381H941.054V259.997H942.266V253.409L944.99 259.997ZM957.4 258.845H953.26V256.133H956.956V254.981H953.26V252.533H957.316V251.381H951.94V259.997H957.4V258.845ZM960.268 259.997V256.757H961.852L964 259.997H965.584L963.244 256.565C964.552 256.253 965.332 255.305 965.332 254.069C965.332 252.353 964.144 251.381 962.164 251.381H958.948V259.997H960.268ZM960.268 252.485H962.08C963.304 252.485 964 253.037 964 254.069C964 255.113 963.304 255.653 962.08 255.653H960.268V252.485ZM973.158 257.477C973.158 256.193 972.33 255.545 970.854 255.245L969.582 254.993C968.778 254.825 968.07 254.537 968.07 253.721C968.07 252.977 968.682 252.317 969.798 252.317C970.878 252.317 971.622 253.037 971.694 254.069H973.038C972.93 252.353 971.574 251.261 969.786 251.261C967.998 251.261 966.726 252.353 966.726 253.805C966.726 255.269 967.83 255.881 969.042 256.121L970.29 256.361C971.286 256.577 971.754 256.937 971.754 257.657C971.754 258.545 970.938 259.061 969.846 259.061C968.526 259.061 967.83 258.353 967.77 257.261H966.426C966.534 258.977 967.794 260.117 969.87 260.117C971.958 260.117 973.158 258.977 973.158 257.477Z"
          fill="#19191B"
        />
        <path
          d="M1068.35 256.351C1068.55 256.156 1068.55 255.839 1068.35 255.644L1065.17 252.462C1064.98 252.267 1064.66 252.267 1064.46 252.462C1064.27 252.657 1064.27 252.974 1064.46 253.169L1067.29 255.998L1064.46 258.826C1064.27 259.021 1064.27 259.338 1064.46 259.533C1064.66 259.728 1064.98 259.728 1065.17 259.533L1068.35 256.351ZM1068 255.498L1028 255.498L1028 256.498L1068 256.498L1068 255.498Z"
          fill="#19191B"
        />
        <path
          d="M848.351 256.35C848.546 256.155 848.546 255.839 848.351 255.643L845.169 252.461C844.974 252.266 844.657 252.266 844.462 252.461C844.267 252.657 844.267 252.973 844.462 253.168L847.29 255.997L844.462 258.825C844.267 259.021 844.267 259.337 844.462 259.532C844.657 259.728 844.974 259.728 845.169 259.532L848.351 256.35ZM847.998 255.497L807.998 255.497L807.998 256.497L847.998 256.497L847.998 255.497Z"
          fill="#19191B"
        />
        <path
          d="M590.645 255.644C590.45 255.839 590.45 256.155 590.645 256.351L593.827 259.533C594.022 259.728 594.339 259.728 594.534 259.533C594.729 259.337 594.729 259.021 594.534 258.826L591.706 255.997L594.534 253.169C594.729 252.974 594.729 252.657 594.534 252.462C594.339 252.266 594.022 252.266 593.827 252.462L590.645 255.644ZM590.999 256.497L630.999 256.497V255.497L590.999 255.497L590.999 256.497Z"
          fill="#19191B"
        />
        <path d="M0.000488281 256H348V257H0.000488281V256Z" fill="#19191B" />
        <path d="M1092 255H1440V256H1092V255Z" fill="#19191B" />
        <circle cx="786.998" cy="257" r="5" fill="#19191B" />
        <circle cx="652" cy="257.001" r="5" fill="#19191B" />
      </g>
      <defs>
        <pattern
          id="pattern0"
          patternContentUnits="objectBoundingBox"
          width="3.27273"
          height="2.04545"
        >
          {/* <use xlink:href="#image0_2201_382" transform="scale(0.00227273)" /> */}
        </pattern>
        <clipPath id="clip0_2201_382">
          <rect
            width="1440"
            height="512"
            fill="white"
            transform="translate(-0.000976562)"
          />
        </clipPath>
      </defs>
    </svg>
  );
}

export default function NichesAnimation() {
  const ref = useRef(null);
  const [media] = useAtom(mediaAtom);

  // console.log(media);

  useEffect(() => {
    if (media === 'mobile') {
      return;
    }

    const ctx = gsap.context(() => {
      gsap.to('.__shape', {
        scrollTrigger: {
          trigger: ref.current,
          start: 'top 70%',
          end: 'bottom 50%',
          scrub: true,
          // markers: true,
        },
        ease: 'power2.inOut',
        rotate: '-20deg',
      });

      gsap.to('.__noise', {
        scrollTrigger: {
          trigger: ref.current,
          start: 'top 70%',
          end: 'bottom 50%',
          scrub: true,
          // markers: true,
        },
        ease: 'power2.inOut',
        opacity: 0,

        rotate: '22deg',
      });

      gsap.to('.__noise2', {
        scrollTrigger: {
          trigger: ref.current,
          start: 'top 70%',
          end: 'bottom 50%',
          scrub: true,
          // markers: true,
        },
        ease: 'power2.inOut',
        opacity: 1,
        rotate: `${45 + 22}deg`,
      });

      const textTrigger = {
        trigger: ref.current,
        start: 'top 35%',
        end: 'bottom 80%',
        scrub: true,
        // markers: true,
      };
      gsap.to('.__left-text', {
        scrollTrigger: textTrigger,
        opacity: 1,
        translateY: 5,
        ease: 'power2.in',

        // top: '55%',
      });

      gsap.to('.__right-text', {
        scrollTrigger: textTrigger,
        ease: 'power2.in',

        opacity: 1,
        translateY: 5,
      });
    }, ref);

    return () => {
      // console.log('running destroy effect');
      ctx.revert();
    };
  }, [media]);

  return (
    <div
      ref={ref}
      className="relative hidden h-[580px] justify-between overflow-hidden md:flex"
    >
      <div></div>
      <div className="__shape absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
        <div className="relative">
          <Shape />
          <Image
            src={Noise}
            alt=""
            className="__noise absolute top-[6.9%] left-[24.1%] h-[440px] w-[440px]"
          />
          <Image
            src={Noise}
            alt=""
            className="__noise2 absolute top-[6.9%] left-[24.1%] h-[440px] w-[440px] rotate-45 opacity-0"
          />
        </div>
      </div>
      <div></div>
      <div></div>
      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
        <Logo />
      </div>
      <div className="__left-text opacity-1 flex w-1/2 pt-[68px] pl-16 text-center text-body-s opacity-0 xl:items-end xl:pb-[200px]">
        <div className="max-w-[176px] xl:ml-auto xl:mr-[470px]">
          We take into account the needs of business
        </div>
      </div>
      <div className="__right-text opacity-1 flex w-1/2 items-end justify-end pb-[68px] pr-16 text-center text-body-s opacity-0 xl:items-center">
        <div className="max-w-[176px] xl:mr-auto xl:ml-[470px]">
          We create user-friendly interfaces
        </div>
      </div>
    </div>
  );

  // return <Shape />;
  // return <Logo />;
  // });
}
